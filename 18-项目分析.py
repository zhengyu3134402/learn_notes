# == == == == == == == == == == == == == == == == == == == == == == == == == == == == ==
# 乱码（模块乱码待整理）
1
# ??????·???
#
# ????????
#
# ?°??
#
# ???§????    ???·????    ??????????    ???￥????    ????????
#
# ????
#
# ???§?￡??    ???·?￡??    ???????￡??    ???￥?￡??    ?????????￡??
#
# ?????°?????? ·????￡??
#
# 1 ???§?￡??
# ·???×￠??????
# ???§±?
# ???§??
# ????
# ????
# ·???????????
# ???§??
# ????
# ·??????§????????
# ??????
# ???·
# ??±?
# ????·???
# ???????￠
#
# ·???
# ???§±?
# id
# ???§??
# ????
# ????
# ??????
# ???·
# ??±?
# ????·???
# ·???
# 1 ???·
# ???????????§??·????????????????????·????????????????￡????·??????????±???
# ???????????§???????????????·￡????????????????????????·±??????§±????? 1????????
# ???·±?
# id
# ??????
# ???·
# ??±?
# ????·???
# ??·?????
# ???§ID
#
# 2 ????????·???
# ·￠??????????????
#
# ???§±?
# id
# ???§??
# ????
# ????
# ????±???
#
# 3 ?????????????????????￡??
# ???????????§?????????????§
# ???§±?
# id
# ???§??
# ????
# ????
# ????±???
# ????±???
# ×???
#
# ???§±?
# id
# ???§??
# ????
# ????
# ????±???
# ????±???
# ???·±?
# id
# ??????
# ???·
# ??±?
# ????·???
# ??·?????
# ???§ID
# ×???·???
# ??????????????·???￡?????·???
# ??????·????????§???????·￡???±?±?????
#
# 2 ???·?￡??
#
# 1 ???·?×??·???
#
# 2 ???·????????·???
# ???·±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·????
# ???·????
# ???·????ID
# ???·????±?
# ID
# ????????
#
# 1 ???·????????·???
# ???????·????????????????
#
# ???·±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·????
# ???·????ID
# ???·????±?
# ID
# ???·????
# ???·id
# ???·????±?
# ID
# ????????
# 2 ????????????·???
# ???????????????±￡??????×??????????????????????￡???????????????????￡??????????·??±???±￡??????×???￡???????????￡??????????￥?±??￡?
#
# ???·±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·????
# ???·????
# ???·????ID
# ???·????±?
# ID
# ???·????
# ???·id
# ???·????±?
# ID
# ????????
#
#
# 3 ???·????·???
# ?????????????§????????￡?????????×?????·??? ???·±???
#
# ???·±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·????
# ???·????ID
# ???·????±?
# ID
# ???·????
# ???·id
# ???·????±?
# ID
# ????????
#
#
# 4 ???·×???·???
# ?????????·?????????±??
# ???????·×???×???
#
# ???·±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·????
# ???·×???
# ???·????ID
# ???·????±?
# ID
# ????????
#
# ???·????±?
# ID
# ???·????
# ???·id
# 5 ?×??????·???
# ?????°????????????logo￡?????logo×???￡?????????????????￡?????????×???
# ???·±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·????
# ???·×???
# ???·????ID
# ???·????±?
# ID
# ????????
# logo
# ????
# ???·????±?
# ID
# ???·????
# ???·id
# 6
# SKU??SPU????·???
#
# SPU ￡?±?×????·?￥??￡?
# ???·???￠??×????￥??￡? ?????￥??
# ?? iphone7????????SPU￡???????￡?????￡?????￡??×??????????
# SKU(???????￥??)
# ???????????????￥??￡?????????￡???￡????????￥?? ￡????·?????￥??
#
# ???·SKU±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·×???
# ???·????ID
# SPU
# ID
#
# ???·SPU±?
# ID
# ????
# ???·????
#
# ???·????±?
# ID
# ????????
# logo
# ????
# ???·????±?
# ID
# ???·????
# ???·SKU
# id
# 7 ·????×?????￥??
#
# ???￥???·±?
# ID
# SKU
# ID
# ????
#
# 1 ???????￥???·????????????
# ????index×???
#
# ???￥???·±?
# ID
# SKU
# ID
# ????
# index
# 8 ·????×??????????????
#
# 1 ????±?
#
# ?×??????????±?
# ID
# ????
# 2 ???÷??????×???????????
# ???? ???????????·×???
#
# ?×??????????±?
# ID
# ????
# ???????·url
# 3 ????????
# ????index
# ?×??????????±?
# ID
# ????
# ???????·url
# index
# 9 ·????×??·??????·??????
#
# ·??????·????±?
#
# id
# SKU
# ID
#
# 1 ????????????
# ????????id
#
# ·??????·????±?
# id
# SKU
# ID
# ????id
#
# 2 ????????
# ????index
#
# ·??????·????±?
# id
# SKU
# ID
# ????id
# index
#
# 3 ????????
# ????????????????????×?￡?????????±???
#
# ·??????·????±?
# id
# SKU
# ID
# ????id
# ????±???
# index
# 10 ???????·????
#
# ???·SKU±???????????
# 1 ???·SKU±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·×???
# ????
# ???·????ID
# SPU
# ID
#
# 3 ×???
# 1 ???·SKU±?
# ID
# ???·??
# ???·????
# ???·????
# ???·?￥??
# ???·????
# ???·????
# ???·×???
# ????
# ???·????ID
# SPU
# ID
#
# 2 ???·SPU±?
# ID
# ????
# ???·????
#
# 3 ???·????±?
# ID
# ????????
# logo
# ????
# 4 ???·????±?
# ID
# ???·????
# ???·SKU
# id
#
# 5 ???￥???·±?
# ID
# SKU
# ID
# ????
# index
# 6 ?×??????????±?
# ID
# ????
# ???????·url
# index
# 7 ·??????·????±?
# id
# SKU
# ID
# ????id
# ????±???
# index
# ·???
# °?????·?????±? ????????????????????
# ???￥??±?￡?????????????????
#
# 3 ???????￡??
# ??????×÷??·±￡?????redis??????????????￡?
# ±￡?????§????????????
#
# 4 ???￥?￡??
# ????????·???
#
# ???￥???￠±?
# ???￥id
# ???§id
# ???·id
# ?§??·???
# ×?????
# ×?????
# ??·?
# ?§??×???
# ?????±??
# 1 ???￥?????·?????????????·
#
# ???????￥???￠±?
#
# ???￥???￠±?
# ID
# ???￥ID
# SKU
# ID
# ???·????
# ???·????
#
# 2 ???￥???·????
# ???￥???￠±?
# ID
# ???￥ID
# SKU
# ID
# ???·????
# ???·????
# ????
#
#
# 3 ????????·????????￡????
#
# BaseModel ×??????????￡????
#
# class BaseModel(models.Model):
#     create_time = models.DateTimeField(auto_now_add=True, verbose_name="?????±??")
#     update_time = models.DateTimeField(auto_now=True, verbose_name="?????±??")
#     is_delete = models.BooleanField(default=False, verbose_name="????±???")
#
#     class Meta:
#         abstract = True  # ???÷???????????￡????
#
#
# 1 ???§??
#
# ????????django???????????§????????????·?·?
#
# ???????§?????±????????????￡?AbstractUser, BaseModel￡?:
#
# class User(Abstractuser, BaseModel):
#
#     def generate_active_token(self):
#         serializer = Serializer(settings.SECRET_KEY, 3600)
#         info = {"confim": self.id}
#         token = serializer.dumps(info)
#         return token.decode()
#
#     class Meta:
#         db_table = "df_user"
#         verbose_name = '???§'
#         verbose_name_plural = verbose_name
#
#
# 2 ???·??
#
# class Address(BaseModel):
#     user = models.ForeignKey("User", verbose_name='???????§')
#     receiver = models.CharField(max_length, verbose_name='??????')
#     addr = models.CharField(max_length=256, verbose_name='???????·')
#     zip_code = models.CharField(max_length=6, null=True, verbose_name="????±???")
#     phone = models.CharField(max_length=11, verbose_name="???????°")
#     id_default = models.BooleanField(default=False, verbose_name="??·?????")
#
#     class Meta:
#         db_table = "df_address"
#         verbose_name = '???·'
#         verbose_name_plural = verbose_name
#
#
# 3 ???·?￡??
#
# class GoodType(BaseModel):
#     name = models.CharField(max_length=20, verbose_name="????????")
#     logo = models.CharField(max_length=20￡? vernpse_name = "±???")  # ??±???
#     image = models.ImageField(upload_to='type', verbose_name="???·????????")
#
#     class Meta:
#         db_table = "df_goods_type"
#         verbose_name = '???·????'
#         verbose_name_plural = verbose_name
#
#     def __str__(self):
#         reutrn
#         self.name
#
#
# 4 ???·SPU?￡????
#
# class Goods(BaseModel):
#     name = models.CharField(max_length=20, verbose_name="???·SPU????")
#     detail = HTMLField(blank=True, verbose_name="???·????")  # ????±?????
#
#     class Meta:
#         db_table = "df_goods"
#         verbose_name = "???·SPU"
#         verbose_name_plural = verbose_name
#
#
# 5 ???·SKU?￡????
#
# status_choices = (
#     (0, "????"),
#     (1, "????"),
# )
# type = models.ForeignKey("GoodsType", verbose_name="???·????")
# goods = models.ForeignKey("Goods", verbose_name="???·SPU")
# name = models.CharField(max_length=20, verbose_name="???·????")
# desc = models.CharField(max_length=256, verbose_name="???·????")
# price = models.Decimalfield(max_digits=10, decimal_places=2, verbose_name="???·????")
# unite = models.CharField(max_length=20, verbose_name="???·?￥??")
# image = models.IntegerField(upload_to="goods", verbose_name="???·????")
# stock = models.IntegerField(default=1, verbose_name="???·????")
# sales = models.IntegerField(default=0, verbose_name="???·????")
# status = models.SmallIntegerField(default=1, choices=status_chices,
#                                   verbose_name="???·×???")  # ??????????￡?choice????????·??§
#
#
# class Meta:
#     db_table = "df_goods_sku"
#     verbose_name = "???·"
#     verbose_name_plural = verbose_name
#
#
# 6 ???·?????￡????
#
# class GoodsImage(BaseModel):
#     sku = models.ForeignKey("GoodsSKU", verbose_name="???·")
#     image = models.ImageField(upload_to="goods", verbose_name="?????·??")
#
#     class Meta:
#         db_table = "df_goods_image"
#         verbose_name = "???·????"
#         verbose_name_plural = verbose_name
#
#
# 7 ???￥???￡????
#
# class IndexGoodsBanner(BaseModel):
#     sku = model.ForeignKey("GoodSKU", verbose_name="???·")
#     image = models.ImageField(upload_to="banner", verbose_name="????")
#     index = models.SmallIntegerField(default=0, verbose_name='????????')
#
#     class Meta:
#         db_table = "df_index_banner"
#         verbose_name = "???￥???·????"
#         verbose_name_plural = verbose_name
#
#
# 8 ?????????￡????
#
# ckass
# IndexPromotionBanner(BaseModel):
# name = models.CharField(max_length=20, verbose_name="????????")
# url = models.URLField(verbose_name="????????")
# image = model.ImageField(upload_to="banner", verbose_name="????????")
# index = models.SmallIntegerField(default=0, verbose_name="????????")
#
#
# class Meta:
#     db_table = "df_index_promotion"
#     verbose_name = "????????"
#     verbose_name_plural = verbose_name
#
#
# 9 ·??????·?????￡??
#
# class IndexTypeGoodsBanner(BaseModel):
#     DISPLAY_TYPE_CHOICES = (
#         (0, "±???"),
#         (1, "????")
#     )
#     type = models.ForeignKey('GoodsType', verbose_name="????????")
#     sku = models.ForeignKey('GoodsSKU', verbose_name="???·SKU")
#     display_type = models.SmallIntegerField(default=1
#     n
#     choices = DISPLAY_TYPE_CHOICES, verbose_name = "????????")
#     index = models.SmallIntegerField(default=0, verbose_name="????????"
#
#     class Meta:
#         db_table = "df_index_type_goods"
#         verbose_name = "·??????????·"
#         verbose_name_plural = verbose_name
#
#
# 10 ???￥???￠??
#
# class OrderInfo(BaseModel):
#     PAY_METHOD_CHOICES = (
#         (1, "????????"),
#         (2, "?￠???§??"),
#         (3, "?§??±?"),
#         (4, "?????§??"),
#     )
#
#     ORDER_STATUS_CHOICES = (
#
#         (1, "???§??"),
#         (2, "??·￠??"),
#         (3, "??????"),
#         (4, "??????"),
#         (5, "??????"),
#     )
#
#     order_id = models.CharField(max_length=128, primary_key=True, verbose_name="???￥±???")
#     user = models.ForeignKey("user.User", verbose_name="???§")  # user.User ?????????? app?????????????￠????
#     addr = models.ForeignKey("user.Address", verbose_name="???·")
#     pay_method = models.SmallIntegerField(choices=PAY_METHOD_CHOICES, default=3, verbose_name="?§??·???")
#     total_count = models.IntegerField(default=1, verbose_name="???·????")
#     total_price = models.DecimalField(max_digits=10, decimal_places=2, verbose_name="×???")
#     transit_price = models.DecimalField(max_digits=10, decimal_places=2, verbose_name="??·?")
#     order_status = models.SmallIntegerField(choices=ORDER_STATUS_CHOICES, default=1, varbose_name="?§??×???")
#     trade_no = models.CharField(max_length=128, verbose_name="?§??±???")
#
#     class Meta:
#         db_table = "df_order_info"
#
#
# 11 ???￥???·?￡??
#
# order = models.ForeignKey("OrderInfo", verbose_name="???￥")
# sku = models.ForeignKey("goods.goodsSKU", verbose_name="???·????SKU")
# count = models.IntegerField(default=1, verbose_name="???·????")
# price = models.DecimalField(max_digits=10, decimal_places=2, verbose_name="???·????")
# comment = models.CharField(max_length=256, verbose_name="????")
#
#
# class Meta:
#     db_table = "df_order_goods"
#
# == == == == == == == == == == == == == == == == == == == == == == == == == == == == ==
#
# == == == == == == == == == == == == == == == == == == == == == == == == == == == == == =
# ????????×???·???????model
# ???§?????????· ???????·?￡?? ?????????§
# ????md5????????·??? ???￠???§???? max_length = 64
# 1 ???§?￡??
#
#
# 3 ???§????
# ???§???????￠??
#
# ???????????§?????￠??￡?
# °??????§??￡????°?????·￡????±??????·??????????§×????????????·???￠
# ￡????§×??????????·???￠￡??°?????????????????￠url?·??×???10?????·￡?
#
# ???§???????￥??￡?
# ???????????§?????￥???￠
#
# 4 ????
# ???????§????????￡??????￥?????????????§?????￠
#
#
# 2 ???·?￡??
#
# 1 ?×??
# ?????????×?????￥???·???￠
# ?????????×?????????￠
# ???????????·?????????￠?￠????
# ?????????×?????????????????????·￡?°??????????·????×????·￡?
# ???÷?????????·?±??×??????·??????????
# 2 ???·??????
#
# ????×???·????????????????·??2?????·???￠
#
# 3 ???·??±???
#
# ???????????????·????±?????￡?·????????￠?§??????￡?????￡?????????
# ??????×???·????????????????·??2?????·???￠
#
# 4 ????
# ???????????÷?????÷???·???￠
#
#
# 3 ??????????
#
# @ @ @ @ @ @ @ @ @ @ @
#
# ??±????????????????·????????????(???????????·)
# ???§??????￡??×??￡???????￡???±??????????????§???????????·??????
# ??????????
# ?????§?????????????·??×÷￡??????????????·￡??????????????????????·??????
#
# == == == == == == == == == == == == == == == == == == == == == == == == == == == == == =
#
# -i
# https: // pypi.douban.com / simple
# 1 ???§?￡??
#
# ?￡??User
# ???§??username
# ????password
# ????email
# ????is_actice
# ???°phone
# ???§?????????·mangytomany(Commodity)
# ???§???￥onetomany￡?Order￡?
#
# ?￡??Address
# address = Foreignkey(user)
#
# 2 ???·?￡??
#
# ?￡??Commodity
# ???·??name
# ???·???￠info
# ???·????price
# ????????inventory
# ????photo  ￡?URLField￡?
# ?￡??Kind
# ??????×?title
# ???·commodity
# Foreignkey
#
# 3 ???????￡??
#
# ?￡??Order
# ???????????·interested_Com
# ???????·??×???total_price
# ???????·??×?????total_nums
# ?????????·buy_coms
# ??·??§?? is_pay
#
# ????·???
# 1 ???§?￡??
#
# 1 ×￠????
# ×￠???±?￡?????§????·???±?×￠??
# ￡?????????°??￥￡????÷°??￥·??????§????·?????±?×￠??￡?
# ???????§???￠??×￠??
# ?????§??×￠??????·￠??????￡????§???÷???????????????????????§???§??????
# ￡?????itsdangerous????????????￡??￠????￡?????·￠??????￡?
#
# 2 ??????
# ???????§??????????
# ￡?1 ????token??????·??????????§??·?????￡?
# 2 ?????????§?????§??????token???￠??????????????uuid????token￡?·????????§
# 3 ???§·￠??????????????????????￡?????token·￠????????￡???????????·?????????????token????
# ?????????§??·???????×????￠????·???±???
# 4 ????????????????????￡????§????·??????°??token????￡??????§??token??????????????????￡?
#
#
# 3 ???§????
# ???§???????￠??
# ￡????????§???????? ??????
# 1 ???????·???????§??username ?? token
# 2 ????username??redis??????token???????·????token????????
# ????????????????????￡????????????§°?￡?
# ???????????§?????￠??￡?
# °??????§??￡????°?????·￡????±??????·??????????§×????????????·???￠
# ￡????§×??????????·???￠￡??°?????????????????￠url?·??×???10?????·￡?
# ???§???????·??￡?
# ???????????§?????????????·￡? ??????·???±??￥???????????§?????????·
# ???§???????￥??￡?
# ???????????§?????￥???￠
# 4 ????
# ???????§????????￡??????￥?????????????§?????￠
#
# 2 ???·?￡??
# ￡????????§?????????·??????????￡????????§?????????????·??????????￡?
# ￡????????·????????????￡????????§????·???￡?
# 1 ?×??
# ?????????×?????￥???·???￠
# ?????????×?????????￠
# ???????????·?????????￠?￠????
# ?????????×?????????????????????·￡?°??????????·????×????·￡?
# ???÷?????????·?±??×??????·??????????
# 2 ???·??????
# ?????????????·?????????￠
# ????×???·????????????????·??2?????·???￠
#
# 3 ???·??±???
# ???????????????·????±?????￡?·????????￠?§??????￡?????￡?????????
# ??????×???·????????????????·??2?????·???￠
#
# 4 ????
# ???????????÷?????÷???·???￠
#
# 3 ??????????
#
# ??±????????????????·????????????
# ???§??????￡??×??￡???????￡???±??????????????§???????????·??????
# ??????????
# ?????§?????????????·??×÷￡??????????????·￡??????????????????????·??????
#
# 4 ???￥????
# ???????￥????￡????????§×?±??????????·???￠
# ???÷???????￥???????￥??????
# ???§?????￥?????????§?????￥???￠
# ???÷?§?????????￥?§??
#
#
#
#
#
#
#
1
# django choice字段的使用
1
#
#     限定选择范围,在页面中是选择标签
#
#     class A(models.Model):
#         a = (
#             (0,"a"),
#             (1, "b")
#         )
#
#     b = models.SmallIntegerField(choice=a)
#
#
1
# django 富文本编辑器
1
#     能够像office一样编写出漂亮的文字页面
#
#     1 安装
#         pip3 install django-tinymce
#
#     2 注册
#         应用注册
#             "tinymce"
#
#     3 配置富文编辑器
#         1 settings中
#             TINYMCE_DEFAULT_CONFIG = {
#                 'theme': 'advanced',  # 高级主题功能多
#                 'width': 600,
#                 'height': 400,
#             }
#
#         2 url.py中
#
#             url(r'tinymce/', include('tinymce.urls')),
#
#     4 使用
#         模型类中
#             from tinymce.models import HTMLField
#             class A(models.Model):
#                 s = HTMLField()
#
# django类型中verbose_name和verbose_name_plural
#
#     成套使用 admin后台管理系统中模型类会显示指定的中文
#     verbose_name = "商品"
#     verbose_name_plural = verbose_name
1

# 4 项目框架的搭建
1
#
#     1 应用配置
#
#         所有应用发到1个apps目录中
#
#             选择1
#
#                 1 注册应用
#                         'apps.应用名'
#                 2 配置路由
#                         模块url放前面，主页url方在最后
#                         url(r'^user/', include('apps.user.urls'))
#
#             选择2
#
#                 settings中添加(即添加了django的搜索路径)
#                     sys.path.insert(0, os.path.join(BASE_DIR, 'app'))
#                 照常--
#                 1 注册应用
#                     '应用名'
#                 2 配置路由
#                     模块url放前面，主页url方在最后
#                     url(r'^user/', include('user.urls'))
#
#     2 定义模型抽象基类
#
#         1 创建目录db
#         2 db中创建base_model.py文件
#             class BaseModel(models.Model):
#                 """模型抽象基类"""
#                 create_time = models.DateTimeField(auto_now_add=True, verbose_name="创建时间")
#                 update_time = models.DateTimeField(auto_now=True, verbose_name="修改时间")
#                 is_delete = models.BooleanField(default=False, verbose_name="删除标记")
#
#                 class Meta:
#                     abstract = True  # 指定说明是一个抽象说明类
#
#     3 把写好的模型类添加到各自类中
#
#     4 指定django认证系统使用的模型类
#         指定之后就不会生产原来的默认表auth_user等
#
#         settings中
#
#             AUTH_USER_MODEL = 'user.User'
#
#
1


# 1 注册逻辑
1
#     1 写视图函数 返回对应 html
#         配置 html 文件引入
#         配置 表单action
#
#         处理函数的一般步骤
#             1 接收数据
#                 username = request.POST.get("username")
#                 password = request.POST.get("pwd")
#                 email = request.POST.get("email")
#                 alloww = request.POST.get("allow")
#
#             2 对数据进行校验
#
#                 校验数据是否含有空
#                 if not all([username, password,email]):
#                     return render(xx)
#
#                 校验邮箱
#                 if not re.match(xx, email)
#                     return render(xx)
#
#                 检验是否同意
#                 if allow != 'on':
#                     return render(xx)
#
#                 校验用户名是否重复
#                 try:
#                     User.objects.get(username=username)
#                 except User.DoesNotExist:
#                     user = None
#                 if user:
#                     return render(xx, {"errmsg":"用户名已存在"})
#
#             3 进行业务处理
#
#                 User.objects.create_user(username, email, password)_
#
#
#             4 发送激活邮件，包含激活链接
#
#                 激活链接中需要包含用户的身份信息，并且把身份信息进行加密
#                 使用itsdangerous
#
#                 加密用户什么信息
#                     serializer = TimewebJson...(settings.SECRET_KEY, 3600)
#                     info = {'confirm':user.id}
#                     token = serializer.dumps{info}.decode("utf8") #
#
#                 发送邮件
#                     发送邮件流程
#                         网站发送邮件-->smtp服务器-->目的邮箱
#                     配置发送邮件(163服务地址)
#                         EMAIL_BACKEND = "django.core.mail.backends.smtp.EmailBackend"
#                         EMAIL_HOST = 'smtp.163.com'
#                         EMAIL_PORT = 25
#                         EMAIL_HOST_USER = '发送邮件的邮箱'
#                         EMAIL_HOST_PASSWORD = '授权码'
#                         EMAIL_FROM = '收件人看到的发件人同EMAIL_HOST_USERS值相同' # 可写成xx<xx@163.com>
#
#                     发邮件（别忘了异步发送邮箱工具celery）
#                         subject = '主题'
#                         message =''
#                         sender = settings.EMAIL_FROM
#                         receiver = ["接收人的邮箱"]
#                         # 如果发送的信息中含有html标签
#                         html_message = '<h1>%s,欢迎</h1>请点击链接激活账户<br><a href="http://127.0.0.1:8000/user/active/%s">http://127.0.0.1:8000/user/active/%s</a>'%(username, token, token)
#                         send_mail(subject, message, sender, receiver, html_message=html_message)
#
#             5 返回应答, 跳转首页
#
#                 return redirect(reverse('good:index'))
#
#
#     2 使用类视图
#         类视图的原理
#             用dispatch方法分发调用 类中的对应的get，post或其他方法
#
#     3 激活视图
#         class Active(View):
#             def get(self, request, token):
#
#                 serializer = TimewebJson...(settings.SECRET_KEY, 3600)
#                 try:
#                     info = serializer.loads(token)
#                     user_id = info['confirm']
#
#                     user = User.objects.get(id=user_id)
#                     user.is_active = 1
#                     user.save()
#
#                     return 返回登录页面
#
#                 except SignatureExpired:
#                     # 激活链接过期，实际提示又发送了一个激活邮件请点击
#                     return HttpResponse('xxx')
1


# 2 登录逻辑

    # 1 登录校验流程

        # from django.contrib.auth import authenticate, login
        # class LoginView(View):
        #
        #     def get(self, request):
        #         判断是否记住了用户名
        #         if 'username' in request.COOKIES:
        #             username = request.COOKIES.get('username')
        #             checked = 'checked'
        #         else:
        #             username = ''
        #             checked = ''
        #         return render(request, 'xx.html', {"username":username, 'check':checked})

        #
        #     def post(self, request):
        #         """登录校验"""

        #
        #         接收数据
        #         username = request.POST.get("username")
        #         password = request.POST.get("pwd")
        #
        #         校验数据
        #         if not all([username, password]):
        #             return render(xxxx)
        #
        #         业务处理:登录校验
        #
        #         user = authenticate(username=username, password=password)
        #         if user is not None:
        #             if user.is_active:
        #                 print("用户已经激活")
        #
        #                 记录登录状态
        #                 login(request, user)
        #                 return redirect(xx)
        #                 获取登录后所要跳转的地址
        #                 next_url = request.GET.get('next', reverse(xx)) # 如果获取不到 设置默认值
        #                 response = redirect(next_url)
        #                 判断是否需要记住用户名
        #                 remember = request.POST.get('remember')
        #                 if remember == 'on':
        #                     response.set_cookie('username', username, max_age=7*24*3600)
        #                 else:
        #                     response.delete_cookie('username')
        #                 return response
        #
        #             else:
        #                 # 用户名密码错误
        #                 return '用户未激活'
        #         else:
        #             return '用户名或密码错误'

    # 2 使用redis存储session信息

        # 方式1
        #     1 安装
        #         pip3 install django-redis-session
        #
        #     2 配置
        #
        #         SESSION_ENGINE = "redis_sessions.session"
        #         SESSION_REDIS_HOST = "localhost"
        #         SESSION_REDIS_PORT = 6379
        #         SESSION_REDIS_DB = 2
        #         SESSION_REDIS_PASSWORD = ''
        #         SESSION_REDIS_PREFIX = 'session'
        #
        #     3 使用
        #         def test(request):
        #             request.session['h1'] = 'hello'
        #             a = reuquest.session.get('h1')
        #             del request.session['h1']
        #             request.session.flush()
        # 方式2
        #
        #     django-redis 使django支持Redis cache/session后端的全功能支持
        #
        #     1 安装
        #         pip3 install django-redis
        #
        #     2 配置
        #
        #
        #             django的配置缓存
        #
        #                 CACHES = {
        #                     "default":{
        #                         "BACKEND":'django_redis.cache.RedisCache',
        #                         "LOCATION": 'redis://127.0.0.1:6379/1',
        #                         "OPTIONS": {
        #                                 "CLIENT_CLASS":"django_redis".clent.DefaultClient,
        #                             }
        #                         }
        #                     }
        #
        #             配置为sesshon存储
        #
        #                 SESSION_ENGINE = "django.contrib.sessions.backends.cache"
        #                 SESSION_CACHE_ALIAS = "default"
        #


# 3 抽离父模板

# 4 登录装饰器和登录后页面跳转

    # 1 配置未登录后的的自动跳转地址
    #
    #     LOGIN_URL = '/XX/XXXX'
    #     注意
    #         前段表单不要设置action属性
    #         因为默认提交地址就是当前页地址
    #         如果设置了action, 获取next参数的时候会出现问题
    # 2 判断用户是否登录
    #
    #     创建类重写as_view方法类判断用户是否登录
    #         from django.contrib.auth.decorators import login_required
    #
    #         class A:
    #             @classmethod
    #             def as_view(cls, **initkwargs):
    #                 view = super(A, cls).as_view(**initkwargs)
    #                 return login_required(view)
    #
    #
    #         视图的使用
    #
    #             class B(A, view):
    #                 .....

# 5 登录后欢迎信息
    
    # is_authenticated() # 除了给模板文件传递的模板变量之外，django框架会吧request.user也传递给模板文件
    # 后端中判断
    # def get(self, request):
    #     # 如果登录a为True(request.user为User类一个实例) 否则False（request.user为AnonymousUser一个实例）
    #     a = request.user.is_authenticated()
    # 前段中判断
    #     {% if user.is_authenticated %}
    #         xxx
    #     {% else %}
    #         yyy
    #     {% end %}